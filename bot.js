const Discord = require('discord.js');
const client = new Discord.Client();
const prefix = '.'

client.on('ready', () => {
  console.log(`Logged in as ${client.user.tag}!`);
  console.log('')
  console.log('')
  console.log('â•”[â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•]â•—')
  console.log(`[Start] ${new Date()}`);
  console.log('â•š[â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•]â•')
  console.log('')
  console.log('â•”[â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•]â•—');
  console.log(`Logged in as * [ " ${client.user.username} " ]`);
  console.log('')
  console.log('Informations :')
  console.log('')
  console.log(`servers! [ " ${client.guilds.size} " ]`);
  console.log(`Users! [ " ${client.users.size} " ]`);
  console.log(`channels! [ " ${client.channels.size} " ]`);
  console.log('â•š[â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•]â•')
  console.log('')
  console.log('â•”[â•â•â•â•â•â•â•â•â•â•â•â•]â•—')
  console.log(' Bot Is Online')
  console.log('â•š[â•â•â•â•â•â•â•â•â•â•â•â•]â•')
  console.log('')
  console.log('')
});





client.on('message' , message => {
if(message.content === '.ovoice') {
    message.channel.send(`**Ø¹Ø¯Ø¯ Ø§Ù„Ø§Ø´Ø®Ø§Øµ Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯ÙŠÙ† Ø¨Ù€  Ø§Ù„Ø±ÙˆÙ…Ø§Øª Ø§Ù„ØµÙˆØªÙŠÙ‡ : ${message.guild.members.filter(g => g.voiceChannel).size}**`);
}
});





client.on('message', function(msg) {
  if(msg.content.startsWith ('.server')) {
    if(!msg.channel.guild) return msg.reply('**:x: Ø§Ø³Ù Ù„ÙƒÙ† Ù‡Ø°Ø§ Ø§Ù„Ø§Ù…Ø± Ù„Ù„Ø³ÙŠØ±ÙØ±Ø§Øª ÙÙ‚Ø· **');         
    let embed = new Discord.RichEmbed()
    .setColor('RANDOM')
    .setThumbnail(msg.guild.iconURL)
    .addField(':globe_with_meridians: **Ø§Ø³Ù… Ø§Ù„Ø³ÙŠØ±ÙØ± : **' , `**[ ${msg.guild.name} ]**`,true)
    .addField(':earth_africa: ** Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø³ÙŠØ±ÙØ± :**',`**[ ${msg.guild.region} ]**`,true)
    .addField(':military_medal:** Ø§Ù„Ø±ØªØ¨ :**',`**[ ${msg.guild.roles.size} ]**`,true)
    .addField(':bust_in_silhouette:** Ø¹Ø¯Ø¯ Ø§Ù„Ø§Ø¹Ø¶Ø§Ø¡ :**',`**[ ${msg.guild.memberCount} ]**`,true)
    .addField(':white_check_mark:** Ø¹Ø¯Ø¯ Ø§Ù„Ø§Ø¹Ø¶Ø§Ø¡ Ø§Ù„Ø§ÙˆÙ†Ù„Ø§ÙŠÙ† :**',`**[ ${msg.guild.members.filter(m=>m.presence.status == 'online').size} ]**`,true)
    .addField(':pencil:** Ø§Ù„Ø±ÙˆÙ…Ø§Øª Ø§Ù„ÙƒØªØ§Ø¨ÙŠØ© :**',`**[ ${msg.guild.channels.filter(m => m.type === 'text').size} ]**`,true)
    .addField(':loud_sound:** Ø±ÙˆÙ…Ø§Øª Ø§Ù„ØµÙˆØª :**',`**[ ${msg.guild.channels.filter(m => m.type === 'voice').size} ]**`,true)
    .addField(':crown:** ØµØ§Ø­Ø¨ Ø§Ù„Ø³ÙŠØ±ÙØ± :**',`**[ ${msg.guild.owner} ]**`,true)
    .addField(':id:** Ø§ÙŠØ¯ÙŠ Ø§Ù„Ø³ÙŠØ±ÙØ± :**',`**[ ${msg.guild.id} ]**`,true)
    .addField(':date:** ØªÙ… Ø¹Ù…Ù„ Ø§Ù„Ø³ÙŠØ±ÙØ± ÙÙŠ : **',msg.guild.createdAt.toLocaleString())
    msg.channel.send({embed:embed});
  }
});








client.on('message', message => {
    if (message.content.startsWith(".bot")) {
    message.channel.send({
        embed: new Discord.RichEmbed()
            .setAuthor(client.user.username,client.user.avatarURL)
            .setThumbnail(client.user.avatarURL)
            .setColor('RANDOM')
            .setTitle('``INFO IST Bot`` ')
            .addField('``My Ping``' , [`${Date.now() - message.createdTimestamp}` + 'MS'], true)
            .addField('``RAM Usage``', `[${(process.memoryUsage().rss / 1048576).toFixed()}MB]`, true)
            .addField('``Servers``', [client.guilds.size], true)
            .addField('``Channels``' , `[ ${client.channels.size} ]` , true)
            .addField('``Users``' ,`[ ${client.users.size} ]` , true)
            .addField('``My Name``' , `[ ${client.user.tag} ]` , true)
            .addField('``My ID``' , `[ ${client.user.id} ]` , true)
                  .addField('``My Prefix``' , `[ . ]` , true)
                  .addField('``My Language``' , `[ Java Script ]` , true)
                  .setFooter('By | ISTeam')
    })
}
});










client.on('message',function(message) {
  if (message.author.bot) return;


                  if(!message.channel.guild) return;

                    if (message.content === prefix + "members") {
 const embed = new Discord.RichEmbed()

    .setDescription(`**Members info âœ¨
 Ø§ÙˆÙ†Ù„Ø§ÙŠÙ†:   ${message.guild.members.filter(m=>m.presence.status == 'online').size}
  Ù…Ù…Ù†ÙˆØ¹ Ø§Ù„Ø§Ø²Ø¹Ø§Ø¬       ${message.guild.members.filter(m=>m.presence.status == 'dnd').size}
  Ø¨Ø¹ÙŠØ¯ Ø¹Ù† Ø§Ù„ÙƒÙŠØ¨ÙˆØ±Ø¯:     ${message.guild.members.filter(m=>m.presence.status == 'idle').size}
  Ø§Ù„Ø§ÙˆÙÙ„Ø§ÙŠÙ†:     ${message.guild.members.filter(m=>m.presence.status == 'offline').size}
   Ø¹Ø¯Ø¯ Ø§Ù„Ø§Ø¹Ø¶Ø§Ø¡:  ${message.guild.memberCount - message.guild.members.filter(m=>m.user.bot).size}
 Ø§Ù„Ø¨ÙˆØªØ§Øª: ${message.guild.members.filter(m=>m.user.bot).size} **`)
         message.channel.send({embed});

    }
      });




client.on('guildCreate', guild => {
  client.channels.get("482739741339418656").send(`**Ù„Ù‚Ø¯ Ù‚Ø§Ù… Ø³ÙŠØ±ÙØ± Ø¢Ø®Ø± Ø¨ Ø§Ø¶Ø§ÙØ© Ø§Ù„Ø¨ÙˆØª âœ…
Ø§Ø³Ù… Ø§Ù„Ø³ÙŠØ±ÙØ±: __${guild.name}__
ØµØ§Ø­Ø¨ Ø§Ù„Ø³ÙŠØ±ÙØ±: __${guild.owner}__**`)
});






client.on('guildMemberAdd', member => {
    let channel = member.guild.channels.find('name', 'âœ°-welcome');
    let memberavatar = member.user.avatarURL
      if (!channel) return;
    let embed = new Discord.RichEmbed()
        .setColor('RANDOM')
        .setThumbnail(memberavatar)
        .addField('ğŸ½ | **Ø§Ù„Ø¥Ø³Ù…** :  ',`${member}`)
        .addField('ğŸ“¢ | **Ù†ÙˆØ±Øª Ø§Ù„Ø³ÙŠØ±ÙØ± ÙŠØ§ Ù‚Ù„Ø¨ÙŠ**' , `**Welcome to IST server**, ${member}`)
        .addField('ğŸ†” | **Ø§Ù„Ø¢ÙŠØ¯ÙŠ** :', "**[" + `${member.id}` + "]**" )
                .addField('â¡| **Ø§Ù†Øª Ø§Ù„Ø¹Ø¶Ùˆ Ø±Ù‚Ù…**',`${member.guild.memberCount}`)
               
                  .addField("Name:",`<@` + `${member.id}` + `>`, true)
                     
                                     .addField(' **Ù†ÙˆØ±Øª Ø³ÙŠØ±ÙØ±**', `${member.guild.name}`,true)
                                       
     .setFooter(`${member.guild.name}`)
        .setTimestamp()
   
      channel.sendEmbed(embed);
    });







const invites = {};
const wait = require('util').promisify(setTimeout);
client.on('ready', () => {
  wait(1000);

  client.guilds.forEach(g => {
    g.fetchInvites().then(guildInvites => {
      invites[g.id] = guildInvites;
    });
  });
});
client.on('guildMemberAdd', member => {
  member.guild.fetchInvites().then(guildInvites => {
    const ei = invites[member.guild.id];
    const invite = guildInvites.find(i => ei.get(i.code).uses < i.uses);
    const inviter = client.users.get(invite.inviter.id);
    const yumz = member.guild.channels.find("name", "Ø§Ø³Ù… Ø±ÙˆÙ…");
     yumz.send(`<@${member.user.id}> joined by <@${inviter.id}>`);
   //  yumz.send(`<@${member.user.id}> joined using invite code ${invite.code} from <@${inviter.id}>. Invite was used ${invite.uses} times since its creation.`);
  }); 
});







client.on('message', ra3d => {
var prefix = ".";
                        let args = ra3d.content.split(" ").slice(1).join(" ")
if(ra3d.content.startsWith(prefix + 'cc')) {
    if(!args) return ra3d.channel.send('`ÙŠØ±Ø¬ÙŠ Ø§Ø®ØªÙŠØ§Ø± ÙƒÙ… Ù„ÙˆÙ† `');
             if (!ra3d.member.hasPermission('ADMINISTRATOR')) return ra3d.channel.sendMessage('`**âš  | `[MANAGE_ROLES]` Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù„Ø¯ÙŠÙƒ ØµÙ„Ø§Ø­ÙŠØ©**'); 
              ra3d.channel.send(`**âœ… |Created __${args}__ Colors**`);
                  setInterval(function(){})
                    let count = 0;
                    let ecount = 0;
          for(let x = 1; x < `${parseInt(args)+1}`; x++){
            ra3d.guild.createRole({name:x,
              color: 'RANDOM'})
              }
            }
  });








const dev = ['303268188244934657'];
client.on('message', message => {
    var argresult = message.content.split(` `).slice(1).join(' ');
      if (!dev.includes(message.author.id)) return;
      
  if (message.content.startsWith(prefix + 'setp')) {
    client.user.setGame(argresult);
      message.channel.send(`**âœ…   ${argresult}**`)
  } else 
  if (message.content.startsWith(prefix + 'setw')) {
  client.user.setActivity(argresult, {type:'WATCHING'});
      message.channel.send(`**âœ…   ${argresult}**`)
  } else 
  if (message.content.startsWith(prefix + 'setl')) {
  client.user.setActivity(argresult , {type:'LISTENING'});
      message.channel.send(`**âœ…   ${argresult}**`)
  } else 
  if (message.content.startsWith(prefix + 'sets')) {
    client.user.setGame(argresult, "https://www.twitch.tv/idk");
      message.channel.send(`**âœ…**`)
  }
  if (message.content.startsWith(prefix + 'setname')) {
  client.user.setUsername(argresult).then
      message.channel.send(`Changing The Name To ..**${argresult}** `)
} else
if (message.content.startsWith(prefix + 'setavatar')) {
  client.user.setAvatar(argresult);
    message.channel.send(`Changing The Avatar To :**${argresult}** `);
}
});






client.on('ready', function(){
  require("./antispam.js")(client, function(message){
     message.delete().then(yumz => {
     message.channel.send(`ØªÙˆÙ‚Ù Ø¹Ù† ØªÙƒØ±Ø§Ø± Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ <@${message.author.id}>`).then(spammer => {
     spammer.delete(2000)
   });
   });
  });
});





client.on('message', message =>{
    let messageArray = message.content.split(" ");
    let cmd = messageArray[0];
    let args = messageArray.slice(1);
    let prefix = '.';
     
    if(cmd === `${prefix}report`){
        let rUser = message.guild.member(message.mentions.users.first() || message.guild.members.get(args[0]));
        if(!rUser) return message.channel.send("Ù‚Ù… Ø¨Ù…Ù†Ø´Ù†Øª Ø§Ù„Ø´Ø®Øµ Ø§Ù„Ø°ÙŠ ØªØ±ÙŠØ¯ ØªÙ‚Ø¯ÙŠÙ… Ø±ÙŠØ¨ÙˆØ±Øª Ø¹Ù„ÙŠÙ‡");
        let reason = args.join(" ").slice(22);
        if(!reason) return message.channel.send("Ù…Ù† ÙØ¶Ù„Ùƒ Ø¶Ø¹ Ø³Ø¨Ø¨");
    
        let reportEmbed = new Discord.RichEmbed()
        .setTitle("Ø±ÙŠØ¨ÙˆØ±Øª Ø¬Ø¯ÙŠØ¯")
        .setColor("#f7abab")
        .addField("- Ø±ÙŠØ¨ÙˆØ±Øª Ø¹Ù„Ù‰ :", `${rUser} (${rUser.id})`)
        .addField("- ØªÙ… ØªÙ‚Ø¯ÙŠÙ… Ø§Ù„Ø±ÙŠØ¨ÙˆØ±Øª Ø¨ÙˆØ§Ø³Ø·Ø© : :", `${message.author} (${message.author.id})`)
        .addField("- ØªÙ… ÙƒØªØ§Ø¨Ø© Ø§Ù„Ø±ÙŠØ¨ÙˆØ±Øª ÙÙŠ Ø±ÙˆÙ… :", message.channel)
        .addField("- Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ø°ÙŠ ÙƒØªØ¨ ÙÙŠÙ‡ Ø§Ù„Ø±ÙŠØ¨ÙˆØ±Øª :", message.createdAt.toLocaleString(),true)
        .addField("- Ø³Ø¨Ø¨ Ø§Ù„Ø±ÙŠØ¨ÙˆØ±Øª :", reason);
    
        let reportschannel = message.guild.channels.find(`name`, "âœ°-reports");
        if(!reportschannel) return message.channel.send("You should to make `reports` channel.");
    
    
        message.delete().catch(O_o=>{});
        message.author.send(`<@${rUser.id}>, ØªÙ… ØªÙ‚Ø¯ÙŠÙ… Ø§Ù„Ø±ÙŠØ¨ÙˆØ±Øª`)
        reportschannel.send(reportEmbed);
    };
});








   client.on('message', message => {
       var prefix ="."
   if(message.content.startsWith(prefix + "invites")) {
    message.guild.fetchInvites().then(invs => {
      let user = message.mentions.users.first() || message.author
      let personalInvites = invs.filter(i => i.inviter.id === user.id);
      let inviteCount = personalInvites.reduce((p, v) => v.uses + p, 0);
               let mmmmEmbed = new Discord.RichEmbed()
                         .setAuthor(client.user.username)
                         .setThumbnail(message.author.avatarURL)
 .addField(` Ù„Ù‚Ø¯ Ù‚Ù…Øª Ø¨Ø¯Ø¹ÙˆØ© :`, ` ${inviteCount} `)
           .setFooter(`- Requested By: ${message.author.tag}`);
           message.channel.send(mmmmEmbed)
});
  }
});






client.on('message', message => {
    if (message.content.startsWith(".hack")) {
      if (message.author.bot) return
           message.delete();
             let args = message.content.split(' ').slice(1);
                   let virusname = args.join(' ');
                 if (virusname < 1) {
                     return message.channel.send("``Ù‚Ù… Ø¨ÙƒØªØ§Ø¨Ø© Ø§Ø³Ù… Ø§Ø§Ù„Ø´Ø®Øµ Ø§Ù„Ø°ÙŠ ØªØ±ÙŠØ¯ ØªÙ‡ÙƒÙŠØ±Ù‡``");
                                     }
                 message.channel.send({embed: new Discord.RichEmbed().setTitle('Loading ' + virusname + "...").setColor(0xFF0000)}).then(function(m) {
             setTimeout(function() {
               m.edit({embed: new Discord.RichEmbed().setTitle('[' + virusname + ']: Loading Discord Virus [â–“ ] 1%').setColor(0xFF0000)})
             }, 1000)
            setTimeout(function() {
               m.edit({embed: new Discord.RichEmbed().setTitle('[' + virusname + ']: Loading Discord Virus [â–“â–“â–“â–“] 25%').setColor(0xFF0000)})
             }, 2000)
           setTimeout(function() {     
               m.edit({embed: new Discord.RichEmbed().setTitle('[' + virusname + ']: Loading Discord Virus [â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“ ] 100%').setColor(0xFF0000)})
             }, 3000)
                setTimeout(function() {
               m.edit({embed: new Discord.RichEmbed().setTitle('[' + virusname + ']: Uploaded! Initiating explosion in 1...').setColor(0xFF0000)})
             }, 4000)
              setTimeout(function() {
               m.delete()
           }, 5000)
             setTimeout(function() {
               message.channel.send('ØªÙ… ØªÙ‡ÙƒÙŠØ±Ùƒ')
           }, 6000)
           });
         }
 });







client.on('message', message => {
   if (message.content === ".id") {
   let embed = new Discord.RichEmbed()
  .setColor("RANDOM")
  .setThumbnail(message.author.avatarURL)
  .addField("Name:",`${message.author.username}`, true)
  .addField('Discrim:',"#" +  message.author.discriminator, true)
  .addField("ID:", message.author.id, true)
  .addField("Create At:", message.author.createdAt, true)


  message.channel.sendEmbed(embed);
    }
});






var ss = 0;

client.on('voiceStateUpdate', (o,n) => {
    if (o.voiceChannel && !n.voiceChannel) {
        ss-=1
        n.guild.channels.get("482975781501272094").edit({
            name : "Voice Online : [" + ss+ "]"
        })
    };
    if (n.voiceChannel && !o.voiceChannel) {
        ss+=1
        n.guild.channels.get("482975781501272094").edit({
            name : "Voice Online : [" + ss+ "]"
        })
    }
})
client.on("ready", () => {
    client.guilds.get("482687318902308874").members.forEach(m => {
        if (m.voiceChannel) {
            ss+=1
        };
        client.channels.get("482975781501272094").edit({
            name : "Voice Online : [" + ss+ "]"
        })
    });
});








client.login(process.env.BOT_TOKEN);
